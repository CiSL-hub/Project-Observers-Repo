<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Obsidian Graph</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #0f0f14;
    }
    #graph {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="graph"></div>

  <script src="https://unpkg.com/force-graph"></script>
  <script>
    fetch("./graph.json")
      .then(r => r.json())
      .then(data => {
        const Graph = ForceGraph()(document.getElementById("graph"))
          .graphData(data)

          // identity
          .nodeId("id")
          .nodeLabel("label")
          .nodeAutoColorBy("group")

          // interaction
          .enableNodeDrag(true)
          .enableZoomPanInteraction(true)

          // physics stability
          .cooldownTicks(200)
          .d3AlphaDecay(0.02)
          .d3VelocityDecay(0.3)

          // visuals
          .nodeRelSize(6)
          .linkOpacity(0.3)

          // click to focus
          .onNodeClick(node => {
            Graph.centerAt(node.x, node.y, 600);
            Graph.zoom(3, 600);
          })

          // prevent node-disappearing hell
          .onNodeDragEnd(node => {
            node.fx = node.x;
            node.fy = node.y;
          });

        // iframe resize safety
        window.addEventListener("resize", () => {
          Graph.width(window.innerWidth);
          Graph.height(window.innerHeight);
        });
      });
  </script>
</body>
</html>
